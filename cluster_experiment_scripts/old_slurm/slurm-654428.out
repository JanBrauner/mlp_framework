sending incremental file list
use 2 GPU(s)
  0%|          | 0/117 [00:00<?, ?it/s][('continue_from_epoch', '-2'), ('seed', '0'), ('task', 'classification'), ('use_gpu', 'True'), ('gpu_id', '0,1'), ('model_name', 'context_encoder'), ('kernel_size', '4'), ('num_layers_enc', '6'), ('num_channels_enc', '64'), ('num_channels_progression_enc', '[1, 1, 2, 4, 8]'), ('num_channels_bottleneck', '8192'), ('num_layers_dec', '6'), ('num_channels_dec', '64'), ('num_channels_progression_dec', '[8, 4, 2, 1, 1]'), ('dataset_name', 'DescribableTextures'), ('num_image_channels', '3'), ('image_height', '128'), ('image_width', '128'), ('normalisation', 'range-11'), ('scale_image', 'None'), ('data_format', 'autoencoding'), ('debug_mode', 'False'), ('num_workers', '4'), ('augment', 'False'), ('gamma_factor', '1'), ('rot_angle', '0'), ('translate_factor', '[0, 0]'), ('scale_factor', '1'), ('shear_angle', '0'), ('patch_mode', 'True'), ('patch_size', '[128, 128]'), ('patch_location_during_training', 'random'), ('patch_rejection_threshold', '10'), ('image_padding_mode', 'None'), ('mask_size', '[64, 64]'), ('batch_size', '8'), ('loss', 'cross_entropy'), ('num_epochs', '200'), ('learning_rate', '0.0002'), ('betas', '[0.5, 0.999]'), ('weight_decay_coefficient', '0'), ('anomaly_dataset_name', 'DTPathologicalIrreg1'), ('AD_patch_stride', '[10, 10]'), ('measure_of_anomaly', 'likelihood'), ('window_aggregation_method', 'mean'), ('save_anomaly_maps', 'True'), ('AD_margins', '[128, 128]'), ('AD_batch_size', '14'), ('experiment_name', 'AE_DTD_r3_prob_patch_128_bn_8192___AD_window_mean')]
Loading data from:  /disk/scratch/s1890594/data/DTPathologicalIrreg1
val set: Continuing anomaly detection with images that weren't processed in previous run
Loading data from:  /disk/scratch/s1890594/data/DTPathologicalIrreg1
test set: Continuing anomaly detection with images that weren't processed in previous run
val set: All images already have corresponding anomaly maps. No new anomaly maps created.
  1%|          | 1/117 [00:46<1:30:25, 46.77s/it]  2%|▏         | 2/117 [01:37<1:31:46, 47.89s/it]  3%|▎         | 3/117 [02:38<1:38:30, 51.85s/it]  3%|▎         | 4/117 [02:54<1:17:29, 41.15s/it]  4%|▍         | 5/117 [03:06<1:00:39, 32.50s/it]  5%|▌         | 6/117 [03:26<53:14, 28.78s/it]    6%|▌         | 7/117 [04:27<1:10:17, 38.34s/it]  7%|▋         | 8/117 [05:06<1:09:51, 38.45s/it]  8%|▊         | 9/117 [05:14<52:59, 29.44s/it]    9%|▊         | 10/117 [05:45<53:20, 29.92s/it]  9%|▉         | 11/117 [06:23<56:55, 32.23s/it] 10%|█         | 12/117 [06:41<49:02, 28.03s/it] 11%|█         | 13/117 [07:30<59:26, 34.29s/it] 12%|█▏        | 14/117 [08:11<1:02:18, 36.29s/it] 13%|█▎        | 15/117 [08:37<56:38, 33.32s/it]   14%|█▎        | 16/117 [09:34<1:07:41, 40.22s/it] 15%|█▍        | 17/117 [09:50<55:12, 33.12s/it]   15%|█▌        | 18/117 [10:56<1:10:54, 42.97s/it] 16%|█▌        | 19/117 [11:50<1:15:17, 46.09s/it] 17%|█▋        | 20/117 [12:06<1:00:11, 37.23s/it] 18%|█▊        | 21/117 [12:18<47:14, 29.53s/it]   19%|█▉        | 22/117 [13:41<1:12:15, 45.64s/it] 20%|█▉        | 23/117 [14:32<1:14:09, 47.34s/it] 21%|██        | 24/117 [15:03<1:05:34, 42.30s/it] 21%|██▏       | 25/117 [15:33<59:12, 38.61s/it]   22%|██▏       | 26/117 [16:28<1:05:54, 43.46s/it] 23%|██▎       | 27/117 [17:34<1:15:34, 50.39s/it] 24%|██▍       | 28/117 [18:23<1:14:13, 50.04s/it] 25%|██▍       | 29/117 [19:08<1:11:00, 48.41s/it] 26%|██▌       | 30/117 [19:43<1:04:28, 44.46s/it] 26%|██▋       | 31/117 [20:24<1:01:59, 43.25s/it] 27%|██▋       | 32/117 [20:43<51:11, 36.13s/it]   28%|██▊       | 33/117 [21:32<56:01, 40.02s/it] 29%|██▉       | 34/117 [22:13<55:34, 40.18s/it] 30%|██▉       | 35/117 [22:53<54:58, 40.23s/it] 31%|███       | 36/117 [23:23<50:16, 37.24s/it] 32%|███▏      | 37/117 [23:36<39:46, 29.83s/it] 32%|███▏      | 38/117 [23:55<34:54, 26.51s/it] 33%|███▎      | 39/117 [24:06<28:21, 21.81s/it] 34%|███▍      | 40/117 [24:36<31:29, 24.53s/it] 35%|███▌      | 41/117 [24:52<27:34, 21.77s/it] 36%|███▌      | 42/117 [25:08<25:03, 20.04s/it] 37%|███▋      | 43/117 [25:25<23:44, 19.25s/it] 38%|███▊      | 44/117 [25:37<20:44, 17.04s/it] 38%|███▊      | 45/117 [25:51<19:14, 16.03s/it] 39%|███▉      | 46/117 [26:07<18:58, 16.03s/it] 40%|████      | 47/117 [26:32<22:03, 18.91s/it] 41%|████      | 48/117 [27:13<29:12, 25.40s/it] 42%|████▏     | 49/117 [27:39<28:55, 25.53s/it] 43%|████▎     | 50/117 [27:54<25:04, 22.46s/it] 44%|████▎     | 51/117 [28:04<20:30, 18.65s/it] 44%|████▍     | 52/117 [28:13<17:11, 15.88s/it] 45%|████▌     | 53/117 [28:54<24:46, 23.22s/it] 46%|████▌     | 54/117 [29:04<20:15, 19.29s/it] 47%|████▋     | 55/117 [29:17<18:04, 17.50s/it] 48%|████▊     | 56/117 [29:30<16:23, 16.12s/it] 49%|████▊     | 57/117 [29:43<15:15, 15.26s/it] 50%|████▉     | 58/117 [30:02<16:04, 16.35s/it] 50%|█████     | 59/117 [30:12<14:03, 14.54s/it] 51%|█████▏    | 60/117 [31:15<27:34, 29.02s/it] 52%|█████▏    | 61/117 [32:31<40:11, 43.05s/it] 53%|█████▎    | 62/117 [33:21<41:16, 45.02s/it] 54%|█████▍    | 63/117 [33:53<37:01, 41.14s/it] 55%|█████▍    | 64/117 [34:12<30:34, 34.61s/it] 56%|█████▌    | 65/117 [35:23<39:25, 45.48s/it] 56%|█████▋    | 66/117 [35:38<30:57, 36.42s/it] 57%|█████▋    | 67/117 [36:51<39:21, 47.22s/it] 58%|█████▊    | 68/117 [37:40<39:04, 47.84s/it] 59%|█████▉    | 69/117 [38:20<36:30, 45.63s/it] 60%|█████▉    | 70/117 [39:02<34:48, 44.44s/it] 61%|██████    | 71/117 [39:23<28:37, 37.34s/it] 62%|██████▏   | 72/117 [40:28<34:19, 45.77s/it] 62%|██████▏   | 73/117 [41:29<36:55, 50.36s/it] 63%|██████▎   | 74/117 [41:50<29:37, 41.33s/it] 64%|██████▍   | 75/117 [42:26<27:55, 39.90s/it] 65%|██████▍   | 76/117 [43:33<32:45, 47.95s/it] 66%|██████▌   | 77/117 [43:57<27:10, 40.77s/it] 67%|██████▋   | 78/117 [44:36<26:10, 40.27s/it] 68%|██████▊   | 79/117 [45:12<24:44, 39.06s/it] 68%|██████▊   | 80/117 [46:12<27:53, 45.24s/it] 69%|██████▉   | 81/117 [47:19<31:04, 51.80s/it] 70%|███████   | 82/117 [47:30<23:08, 39.67s/it] 71%|███████   | 83/117 [48:17<23:39, 41.74s/it] 72%|███████▏  | 84/117 [48:56<22:28, 40.87s/it] 73%|███████▎  | 85/117 [49:35<21:36, 40.52s/it] 74%|███████▎  | 86/117 [50:04<19:09, 37.07s/it] 74%|███████▍  | 87/117 [50:45<19:03, 38.11s/it] 75%|███████▌  | 88/117 [51:26<18:46, 38.85s/it] 76%|███████▌  | 89/117 [52:15<19:35, 41.99s/it] 77%|███████▋  | 90/117 [53:33<23:45, 52.79s/it] 78%|███████▊  | 91/117 [53:57<19:05, 44.05s/it] 79%|███████▊  | 92/117 [54:47<19:07, 45.89s/it] 79%|███████▉  | 93/117 [56:02<21:54, 54.78s/it] 80%|████████  | 94/117 [56:41<19:10, 50.00s/it] 81%|████████  | 95/117 [57:30<18:13, 49.70s/it] 82%|████████▏ | 96/117 [58:27<18:09, 51.88s/it] 83%|████████▎ | 97/117 [58:53<14:44, 44.22s/it] 84%|████████▍ | 98/117 [59:19<12:14, 38.68s/it] 85%|████████▍ | 99/117 [1:00:37<15:05, 50.32s/it] 85%|████████▌ | 100/117 [1:01:13<13:04, 46.15s/it] 86%|████████▋ | 101/117 [1:01:59<12:17, 46.08s/it] 87%|████████▋ | 102/117 [1:02:45<11:30, 46.05s/it] 88%|████████▊ | 103/117 [1:03:24<10:16, 44.07s/it] 89%|████████▉ | 104/117 [1:04:23<10:29, 48.42s/it] 90%|████████▉ | 105/117 [1:05:09<09:33, 47.78s/it] 91%|█████████ | 106/117 [1:05:20<06:42, 36.63s/it] 91%|█████████▏| 107/117 [1:06:09<06:42, 40.26s/it] 92%|█████████▏| 108/117 [1:06:47<05:58, 39.84s/it] 93%|█████████▎| 109/117 [1:07:34<05:34, 41.81s/it] 94%|█████████▍| 110/117 [1:08:39<05:42, 48.93s/it] 95%|█████████▍| 111/117 [1:09:54<05:39, 56.59s/it] 96%|█████████▌| 112/117 [1:11:10<05:12, 62.50s/it] 97%|█████████▋| 113/117 [1:12:18<04:16, 64.18s/it] 97%|█████████▋| 114/117 [1:13:01<02:53, 57.77s/it] 98%|█████████▊| 115/117 [1:13:53<01:52, 56.08s/it] 99%|█████████▉| 116/117 [1:14:45<00:54, 54.70s/it]100%|██████████| 117/117 [1:15:16<00:00, 47.64s/it]
test set results:
Mean  aucroc :  0.6588
