sending incremental file list
./
use 6 GPU(s)
  0%|          | 0/29 [00:00<?, ?it/s][('continue_from_epoch', '-1'), ('seed', '0'), ('task', 'regression'), ('use_gpu', 'True'), ('gpu_id', '0,1,2,4,5,6'), ('model_name', 'context_encoder'), ('kernel_size', '4'), ('num_layers_enc', '6'), ('num_channels_enc', '64'), ('num_channels_progression_enc', '[1, 1, 2, 4, 8]'), ('num_channels_bottleneck', '4000'), ('num_layers_dec', '5'), ('num_channels_dec', '64'), ('num_channels_progression_dec', '[8, 4, 2, 1]'), ('dataset_name', 'MiasHealthy'), ('num_image_channels', '1'), ('image_height', '128'), ('image_width', '128'), ('normalisation', 'range-11'), ('scale_image', '[1, 1]'), ('data_format', 'inpainting'), ('debug_mode', 'False'), ('num_workers', '12'), ('augment', 'True'), ('gamma_factor', '1'), ('rot_angle', '15'), ('translate_factor', '[0, 0]'), ('scale_factor', '1.2'), ('shear_angle', '6'), ('patch_mode', 'True'), ('patch_size', '[128, 128]'), ('patch_location_during_training', 'random'), ('patch_rejection_threshold', '10'), ('image_padding_mode', 'constant'), ('mask_size', '[64, 64]'), ('batch_size', '50'), ('loss', 'L2'), ('num_epochs', '200'), ('learning_rate', '0.0002'), ('betas', '[0.5, 0.999]'), ('weight_decay_coefficient', '0'), ('anomaly_dataset_name', 'MiasPathological'), ('AD_patch_stride', '[10, 10]'), ('measure_of_anomaly', 'absolute distance'), ('window_aggregation_method', 'mean'), ('save_anomaly_maps', 'True'), ('AD_margins', 'None'), ('AD_batch_size', '50'), ('experiment_name', 'r7_CE_Mias_stand_scale_1')]
Loading data from:  /disk/scratch/s1890594/data/MiasHealthy
Loading data from:  /disk/scratch/s1890594/data/MiasHealthy
Loading data from:  /disk/scratch/s1890594/data/MiasHealthy
/mnt/mscteach_home/s1890594/mlp_framework/results/r7_CE_Mias_stand_scale_1 /mnt/mscteach_home/s1890594/mlp_framework/results/r7_CE_Mias_stand_scale_1/result_outputs

Traceback (most recent call last):
  File "main.py", line 54, in <module>
    experiment_metrics, test_metrics = experiment.run_experiment()  
  File "/mnt/mscteach_home/s1890594/mlp_framework/experiment_builder.py", line 256, in run_experiment
    loss = self.run_train_iter(x=x, y=y)  # take a training iter step
  File "/mnt/mscteach_home/s1890594/mlp_framework/experiment_builder.py", line 117, in run_train_iter
    out, loss = self.forward_prop_and_loss(x,y)
  File "/mnt/mscteach_home/s1890594/mlp_framework/experiment_builder.py", line 183, in forward_prop_and_loss
    out = self.model.forward(x)  # forward the data in the model
  File "/home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/nn/parallel/data_parallel.py", line 151, in forward
    replicas = self.replicate(self.module, self.device_ids[:len(inputs)])
  File "/home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/nn/parallel/data_parallel.py", line 156, in replicate
    return replicate(module, device_ids)
  File "/home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/nn/parallel/replicate.py", line 97, in replicate
    param_copies = _broadcast_coalesced_reshape(params, devices, detach)
  File "/home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/nn/parallel/replicate.py", line 80, in _broadcast_coalesced_reshape
    tensor_copies = Broadcast.apply(devices, *tensors)
  File "/home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/nn/parallel/_functions.py", line 21, in forward
    outputs = comm.broadcast_coalesced(inputs, ctx.target_gpus)
  File "/home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/cuda/comm.py", line 39, in broadcast_coalesced
    return torch._C._broadcast_coalesced(tensors, devices, buffer_size)
RuntimeError: CUDA out of memory. Tried to allocate 126.00 MiB (GPU 3; 5.94 GiB total capacity; 11.32 MiB already allocated; 5.50 GiB free; 2.68 MiB cached) (malloc at /opt/conda/conda-bld/pytorch_1556653215914/work/c10/cuda/CUDACachingAllocator.cpp:267)
frame #0: c10::Error::Error(c10::SourceLocation, std::string const&) + 0x45 (0x7fe30c0cedc5 in /home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x16ca7 (0x7fe304161ca7 in /home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x17347 (0x7fe304162347 in /home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/lib/libc10_cuda.so)
frame #3: at::native::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&) + 0x274 (0x7fe311c7bf34 in /home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/lib/libcaffe2_gpu.so)
frame #4: at::CUDAType::empty(c10::ArrayRef<long>, c10::TensorOptions const&) const + 0x19b (0x7fe3106794cb in /home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/lib/libcaffe2_gpu.so)
frame #5: torch::autograd::VariableType::empty(c10::ArrayRef<long>, c10::TensorOptions const&) const + 0x268 (0x7fe304da2bf8 in /home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/lib/libtorch.so.1)
frame #6: at::native::to(at::Tensor const&, c10::Device, c10::ScalarType, bool, bool) + 0x687 (0x7fe30ca9c457 in /home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/lib/libcaffe2.so)
frame #7: at::TypeDefault::to(at::Tensor const&, c10::Device, c10::ScalarType, bool, bool) const + 0x1b (0x7fe30cd1c7eb in /home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/lib/libcaffe2.so)
frame #8: torch::autograd::VariableType::to(at::Tensor const&, c10::Device, c10::ScalarType, bool, bool) const + 0x312 (0x7fe304c8e5c2 in /home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/lib/libtorch.so.1)
frame #9: torch::cuda::broadcast(at::Tensor const&, c10::ArrayRef<long>) + 0x100 (0x7fe3051e31d0 in /home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/lib/libtorch.so.1)
frame #10: torch::cuda::broadcast_coalesced(c10::ArrayRef<at::Tensor>, c10::ArrayRef<long>, unsigned long) + 0x439 (0x7fe3051e3829 in /home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/lib/libtorch.so.1)
frame #11: <unknown function> + 0x5a912e (0x7fe33231812e in /home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #12: <unknown function> + 0x12d07a (0x7fe331e9c07a in /home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #21: THPFunction_apply(_object*, _object*) + 0x691 (0x7fe33211e891 in /home/s1890594/miniconda3/envs/mlp/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #50: __libc_start_main + 0xf5 (0x7fe33ca4a3d5 in /lib64/libc.so.6)

